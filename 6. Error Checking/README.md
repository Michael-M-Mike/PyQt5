# Separation of Concerns

Before jumping into code, we need to introduce the idea of separation of concerns.

As projects get larger, multiple people will have to work on multiple aspects of the projects.

For example, in our CPU Scheduler project, we'd have one person that writes the code for the scheduling algorithms and another that deals with the GUI code.

Each person will work in a separate file and thus some design structure must be adopted in order for the project to work properly.

## Model-View-Controller

MVC is a common software design pattern which divides the software into three components:
- Model
  - It contains the logic and functionality of the project that is **INDEPENDANT** of the user interface.
- View
  - It contains anything that is related to the GUI.
- Controller
  - This is the linker between the two. It makes sure that the model and the view work together properly.

However we don't really need all 3 components, because the code generated by Qt designer is basically the view and the controller combined.
So we'll use a **Model-View** structure, where the project will be divided into 2 files:
- model.py
- view.py

# Titanic Survivors

A very popular dataset used in machine learning is the titanic dataset. It's used to train machine learning algorithms so that they can predict whether a person survived the titanc, given his ticket class, sex, and age.
To see error handling and MV structure in action, we'll create a very simplified version of this. It'll will look like this. 

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/tit2.PNG)

It's simply just a table where the user fills the persons' names, sex, and age and after clicking on "check survivors" pushbutton, the last column in the table will be filled to show whether each person survived or died.

The decision is based on this table:

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t1.PNG)

________________________________________________________________________________________________________________________________

# 1. Design

Drag a title label, a table widget, some pushbuttons as shown:

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t3.PNG)

Put the 2 pushbuttons above the table in a horizontal layout:

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t4.PNG)

Select all and lay them out vertically (Also right click the title label and in *layout alignment* pick *center horizontally*):

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t5.PNG)

Insert a **Vertical Spacer** below the title and select its sizePolicy to be fixed. **Spacers** are a way to have some whitespace between widgets in a layout.

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t6.PNG)

Don't worry about colours or stylesheets, we'll use a pre-made stylesheet to have the dark theme shown above. However you can pick the font and the font size you prefer. 

Also double click the table widget and add rows and columns so it looks like the image above as well.

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t7.PNG)

We don't want to worry about resizing the project window so we'll give it a **fixed** width and height.

![](https://github.com/Michael-M-Mike/PyQt5/blob/master/img/t8.PNG)

_______________________________________________________________________________________________________________________________

# 2. Code Structure

The code generated by Qt Designer will be our view.py. It'll also contain the error checking and handling.

model.py will contain:
- A person Class which has the following attributes:
  - name
  - tclass
  - sex
  - age

- A function called *survived(person)* that takes a person object and outputs:
  - **True** if the person survived
  - **False** if the person died
  
  _______________________________________________________________________________________________________________________________

# 3. Error Checking and Handling

First let's define the add and remove functions that add and remove table entries:

```python

def add_entry(self):

    # Add table row
    self.tableWidget.insertRow(self.rows)

    # Center Alignment
    for col in range(5):
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignCenter)
        self.tableWidget.setItem(self.rows, col, item)

    self.rows += 1

def remove_entry(self):
    # Remove table row
    if self.rows > 0:
        self.rows -= 1
        self.tableWidget.removeRow(self.rows)
```

Those are the 2 functions that are called when the *Add Entry* and *Remove Entry* pushbuttons are pressed.
*self.rows* is an attribute initialized as 0.

Now when *Check Survivors* is pressed, we need to:

1. Get the data from the table (Each row is a Person object)
2. Call the *survived* function to know whether the person survived or not.
3. Fill the last column of the table with the return of that function.

But what if the user enterd an unexpected input?

We expect age to be "Adult" or "Child". 

But the user doesn't know that. 

They could enter 22 or 19 or "kid" or "banana" or 587.415 or *#&@#$% or [1, "dsa, @#$%, []] or {}{}}}{{{.

Moral of the story: The user will enter something we aren't expecting. And as you've seen already, any unexpected input or any runtime error will cause the GUI to crash.

The solution is to never trust user input and whenever we get an input from the user, we must validate it and make sure it's an input that we're ok with.

Here are the revised steps:
1. Get the data from the table (Each row is a Person object)
--> 1.1. Validate the data and don't go to step 2 unless the inputs are valid.
2. Call the *survived* function to know whether the person survived or not.
3. Fill the last column of the table with the return of that function.
